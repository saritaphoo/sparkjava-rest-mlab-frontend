    <!-- This sets JavaScript mode in emacs -*- mode: Javascript;-*- -->
    <script>

var site_globals = {};

function handleGetPosts(data) {

    
    // write message to console (for debugging only)
    console.log("handleGetPosts: " + JSON.stringify(data));

    // a for loop over the array of posts
    
    $.each(data,function(i,post) {
	var row = $("<tr></tr>");
	row.append($("<td></td>").text(post.id));
	row.append($("<td></td>").text(post.title));
	row.append($("<td></td>").text(JSON.stringify(post.categories)));
	// Append this to every <tbody class="put-posts-here"> element
	$('tbody.post-table-body').append(row);
    });

    // remove the loading element inside the table
    $('tbody.post-table-body tr.tr-3col-loading').remove();
}	  
    
$(document).ready(function() {
    // grab a copy of the #tr-3col-loading element

    site_globals.tr_3col_loading = $(".tr-3col-loading").first().clone();

    // load the posts once when the page first loads
    $.ajax({
	url: "/api/posts"
    }).then(handleGetPosts);
});

</script>
